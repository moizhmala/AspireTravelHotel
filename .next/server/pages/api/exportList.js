"use strict";(()=>{var e={};e.id=1,e.ids=[1],e.modules={1428:e=>{e.exports=import("axios")},2222:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>i});var o=r(1428),s=r(5751),a=e([o]);async function i(e,t){let r;if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{environment:n,queryParams:a,language:i="default"}=e.body;if(!n||!["dev","prod"].includes(n))return t.status(400).json({error:"Invalid or missing environment"});let u=a?.["system.type"];if(!u||""===u.trim())return t.status(400).json({error:"Please select a list (system.type) to export."});let l=process.env[`KONTENT_${n.toUpperCase()}_PROJECT_ID`],p=process.env[`KONTENT_${n.toUpperCase()}_DELIVERY_BASE_URL`]||"https://deliver.kontent.ai",c=process.env[`KONTENT_${n.toUpperCase()}_DELIVERY_API_KEY`];if(!l||!c||!p)return t.status(500).json({error:"Missing environment config"});let d=e.body.apiUrl||`${p}/${l}/items`,f=[];try{for(;;){let e={Authorization:`Bearer ${c}`};r&&(e["x-continuation"]=r);let t={...a,language:i};console.log("Final queryParams:",t);let n=(await o.default.get(d,{params:t,headers:e})).data;if(!n.items||n.items.length<1)break;for(let e of n.items){let t=e.system?.type;t&&t===a["system.type"]&&e.elements&&("country_list"===t?f.push({"Country Name":e.elements.country_title?.value||"","Country Code":e.elements.country_code?.value||"","Country Three Letter":e.elements.country_three_letter?.value||"","Country Currency":e.elements.country_currency?.value||""}):f.push({Title:e.elements.title?.value||""}))}if(!(r=n.continuationToken))break}if(0===f.length)return t.status(404).json({error:"No data found"});let e=s.utils.json_to_sheet(f),u=s.utils.book_new(),l=a["system.type"]?.replace(/[\\/:*?"<>|]/g,"_")||"data";s.utils.book_append_sheet(u,e,l);let p=s.write(u,{type:"buffer",bookType:"xlsx"}),m=`TravelHotel_${n}_${l}.xlsx`;t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t.setHeader("Content-Disposition",`attachment; filename="${m}"`),t.status(200).send(p)}catch(e){return console.error("API Error:",e.message||e),t.status(500).json({error:"Failed to fetch or process data"})}}o=(a.then?(await a)():a)[0],n()}catch(e){n(e)}})},3480:(e,t,r)=>{e.exports=r(5600)},4192:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>p,default:()=>l,routeModule:()=>c});var o=r(3480),s=r(8667),a=r(6435),i=r(2222),u=e([i]);i=(u.then?(await u)():u)[0];let l=(0,a.M)(i,"default"),p=(0,a.M)(i,"config"),c=new o.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/exportList",pathname:"/api/exportList",bundlePath:"",filename:""},userland:i});n()}catch(e){n(e)}})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5751:e=>{e.exports=require("xlsx")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=4192);module.exports=r})();