{"version":3,"sources":["../../../../TravelHotel/src/utils/headerfootergenerator.ts","../../../../TravelHotel/src/pages/api/uploadheaderfooter.ts","../../../../TravelHotel/node_modules/next/src/build/templates/pages-api.ts"],"sourcesContent":["import fs from \"fs\";\nimport csv from \"csv-parser\";\nimport axios, { AxiosError } from \"axios\";\nimport dotenv from \"dotenv\";\nimport getKontentConfig from \"./config\";\nimport * as xlsx from \"xlsx\";\nimport { console } from \"inspector\";\nimport { create } from \"domain\";\n\n\ndotenv.config();\n\ninterface Config {\n  projectId: string;\n  apiKey: string;\n  baseUrl: string;\n  contentTypeCodename: string;\n  _DELIVERY_BASE_URL: string;\n  deliveryApiKey: string;\n}\n\ninterface ValidationError {\n  message: string;\n}\n\ninterface ApiErrorResponse {\n  validation_errors: ValidationError[];\n}\n\nconst DEV_PROJECT_ID = process.env.KONTENT_DEV_PROJECT_ID || \"\";\nconst PROD_PROJECT_ID = process.env.KONTENT_PROD_PROJECT_ID || \"\";\n\nconst config: Config = getKontentConfig();\n\ntype LanguageMap = {\n  [key: string]: {\n    codename: string;\n    id: string;\n  };\n};\n\nconst languageMap: LanguageMap = {\n  \"default\": { codename: \"default\", id: \"00000000-0000-0000-0000-000000000000\" },\n  \"de-DE\": { codename: \"de-DE\", id: \"79228548-6576-5a60-acad-53360bf23687\" },\n  \"ja-JP\": { codename: \"ja-JP\", id: \"4e8fa49a-27d3-44a7-8135-3dc21008ddd1\" },\n  \"ko-KR\": { codename: \"ko-KR\", id: \"ce929a3d-f7df-4ab1-a1b5-aaa38a7a4812\" },\n  \"zh-HK\": { codename: \"zh-HK\", id: \"e832b221-cbe7-442a-8edf-98a7ac7afac6\" },\n  \"zh-TW\": { codename: \"zh-TW\", id: \"f0666814-0e42-48c7-a4c9-dea7c1d7b2ed\" },\n  \"ar-AE\": { codename: \"ar-AE\", id: \"3dc9c67d-95d8-4594-890d-70f98c615fbd\" },\n  \"es-MX\": { codename: \"es-MX\", id: \"0814121f-7011-4361-b7bd-cebd74fe4cd9\" }\n};\n\n\n// const elementIdMap: Record<string, string> = {\n//   \"Web Header HTML\": \"96941a4c-bc8f-4eb1-8f65-9e023e1b6d22\",\n//   \"Web Header Style\": \"e7036234-8439-4230-b4f4-ef0ab56fd364\",\n//   \"Web Header Script\": \"89d8f6a7-3d8d-4fc1-803a-bf20a1f71887\",\n//   \"Web Footer HTML\": \"b38392bd-ee06-4aa2-a377-0888f9fa5183\",\n//   \"Web Footer Style\": \"f64c4c3c-807c-47b0-87d0-b6c03dd1044f\",\n//   \"Web Footer Script\": \"5ab4f5fa-4a82-443a-aec9-5b1f30048f6c\",\n//   \"Email Header HTML\": \"header_html\",\n//   \"Email Header Style\": \"header_css\",\n//   \"Email Header Script\": \"header_script\",\n//   \"Email Footer HTML\": \"footer_html\",\n//   \"Email Footer Style\": \"footer_css\",\n//   \"Email Footer Script\": \"footer_script\",\n// };\n\nasync function fetchElementIdMap(contentTypeCodename: string): Promise<Record<string, string>> {\n  try {\n    require(\"fs\").appendFileSync(\"debug.txt\", `Fetching element ID map for type: ${config.baseUrl}/${config.projectId}/types/codename/${contentTypeCodename}` + \"\\n\");\n    const response = await axios.get(\n      `${config.baseUrl}/${config.projectId}/types/codename/${contentTypeCodename}`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n\n    const elementMap: Record<string, string> = {};\n\n    for (const element of response.data.elements) {\n      elementMap[element.name.trim()] = element.id;\n    }\n\n    return elementMap;\n  } catch (error) {\n    console.error(`‚ùå Error fetching element ID map for type \"${contentTypeCodename}\":`, error);\n    throw error;\n  }\n}\n\nexport const validateCsv = (filePath: string): Promise<void> => {\n  const REQUIRED_HEADERS = Object.keys(languageMap);\n  return new Promise((resolve, reject) => {\n    const headersSet = new Set<string>();\n    let hasDataRow = false;\n\n    fs.createReadStream(filePath)\n      .pipe(csv())\n      .on(\"headers\", (headers) => {\n        headers.forEach((header: string) => headersSet.add(header.trim())); // Normalize headers\n      })\n      .on(\"data\", () => {\n        hasDataRow = true; // At least one data row exists\n      })\n      .on(\"end\", () => {\n        const missingHeaders = REQUIRED_HEADERS.filter(\n          (header) => !headersSet.has(header)\n        );\n\n        if (missingHeaders.length > 0) {\n          return reject(\n            new Error(`Missing required headers: ${missingHeaders.join(\", \")}`)\n          );\n        }\n\n        if (!hasDataRow) {\n          return reject(\n            new Error(\"CSV must contain at least one row of data.\")\n          );\n        }\n\n        resolve();\n      })\n      .on(\"error\", (err) => {\n        reject(new Error(\"Error reading CSV file: \" + err.message));\n      });\n  });\n};\n\nasync function findContentItem(contentItemCodename: string) {\n  try {\n    // console.log(\n    //   `Finding content item with codename: ${config.baseUrl}/${config.projectId}/items/codename/${contentItemCodename}`\n    // );\n    const response = await axios.get(\n      `${config.baseUrl}/${config.projectId}/items/codename/${contentItemCodename}`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n    return response.data;\n  } catch (error) {\n    console.error(`Error finding content item: ${error}`);\n    return false;\n  }\n}\n\nasync function findContentItemVariant(contentItemID: string, languageCodename: string) {\n  try {\n    require(\"fs\").appendFileSync(\"debug.txt\", `Finding content item variant: ${config.baseUrl}/${config.projectId}/items/${contentItemID}/variants/${languageCodename}` + \"\\n\");\n    const response = await axios.get(\n      `${config.baseUrl}/${config.projectId}/items/${contentItemID}/variants/codename/${languageCodename}`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n    return response.data;\n  } catch (error) {\n    console.error(`Error finding content item variant: ${error}`);\n    return false;\n  }\n}\n\nasync function deleteExistingDraftVersion (contentItemID: string, languageCodename: string, contentItemVariant: any) { \n  try {\n\n    //get content item variant\n    const contentItemVariant =await findContentItemVariant(contentItemID, languageCodename);\n\n    //check content item variant workflow step\n    require(\"fs\").appendFileSync(\"debug.txt\", `Current workflow step for ${languageCodename}: ${contentItemVariant.workflow_step?.id || 'N/A'}` + \"\\n\");\n\n    if (contentItemVariant.workflow_step?.id === \"eee6db3b-545a-4785-8e86-e3772c8756f9\") { //draft step id\n      require(\"fs\").appendFileSync(\"debug.txt\", `Deleting existing draft version for: ${config.baseUrl}/${config.projectId}/items/${contentItemID}/variants/codename/${languageCodename}` + \"\\n\"); \n      const response = await axios.delete( \n        `${config.baseUrl}/${config.projectId}/items/${contentItemID}/variants/codename/${languageCodename}`,\n        { \n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${config.apiKey}`,\n          },\n        } \n      );  \n      require(\"fs\").appendFileSync(\"debug.txt\", `‚úÖ Deleted existing draft version for language: ${languageCodename}` + \"\\n\");\n      return response.data; \n    } \n  } catch (error) {\n    console.error(`Error deleting existing draft version: ${error}`);\n    throw error;\n  }\n}\n\nasync function createContentItem(itemName: string, itemCodename: string, contentTypeCodename: string) {\n  try {\n    const response = await axios.post(\n      `${config.baseUrl}/${config.projectId}/items`,\n      {\n        name: itemName,\n        codename: itemCodename,\n        type: { codename: contentTypeCodename },\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n    require(\"fs\").appendFileSync(\"debug.txt\", `‚úÖ Created content item: ${itemCodename}` + \"\\n\");\n    return response.data;\n  } catch (error) {\n    require(\"fs\").appendFileSync(\"debug.txt\", `Error creating content item: ${error}` + \"\\n\");\n    throw error;\n  }\n}\n\nasync function createLanguagVariant(\n  itemId: string,\n  languageId: string\n) {\n  try {\n\n   //let contentItem = await findContentItemVariant(itemId, languageId);\n    //if (contentItem) {\n       //require(\"fs\").appendFileSync(\"debug.txt\", `Creating language variant ${config.baseUrl}/${config.projectId}/items/${itemId}/variants/${languageId}/new-version` + \"\\n\");\n      const response = await axios.put(\n        `${config.baseUrl}/${config.projectId}/items/${itemId}/variants/codename/${languageId}/new-version`,\n        {}, // empty body\n        {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${config.apiKey}`,\n          },\n        }\n      );\n      fs.appendFileSync(\"debug.txt\", `‚úÖ Variant new version created for language ${languageId}` + \"\\n\");\n    return response.data;\n    //}\n   \n    \n    \n  } catch (error) {\n    //console.error(`Error creating language variant: ${error}`);\n    require(\"fs\").appendFileSync(\"debug.txt\", `Error creating language variant: ${error}` + \"\\n\");\n    throw error;\n  }\n}\n\nasync function addLanguageVariant( itemId: string, languageId: string, templateName: string, nameValue: string, clientidValue: string, programidValue: string,\n  elements: {\n    element: { codename: string };\n    value: string;\n  }[]\n  \n) {\n  try {\n    require(\"fs\").appendFileSync(\"debug.txt\", `Adding language variant ${config.baseUrl}/${config.projectId}/items/${itemId}/variants/${languageId}` + \"\\n\");  \n\n    const customHeaders = {\n      'Content-Type': 'application/json',\n      \"Accept\": \"application/json\",\n      \"Authorization\": `Bearer ${config.apiKey}`\n    };\n\n    const AppendElements = [\n      {\n        element: {\n          codename: \"content_type\"\n        },\n        value: [\n          { codename: templateName }\n        ]\n      },\n      {\n        element: {\n          codename: \"name\"\n        },\n        value: nameValue\n      },\n      {\n        element: {\n          codename: \"client_availability\"\n        },\n        value: [\n          { codename: \"client_availability_list_restricted\" }\n        ]\n      },\n      {\n        element: {\n          codename: \"client_id\"\n        },\n        value: [\n          { codename: clientidValue }\n        ]\n      },\n      {\n        element: {\n          codename: \"program_id\"\n        },\n        value: [\n          { codename: programidValue }\n        ]\n      }\n    ];\n\n    const requestBody = {\n      elements: [...elements, ...AppendElements],\n      \n    };\n\n    require(\"fs\").appendFileSync(\"debug.txt\", `requestBody to add: ${JSON.stringify(requestBody, null, 2)}` + \"\\n\");\n\n    const response = await axios.put(\n      `${config.baseUrl}/${config.projectId}/items/${itemId}/variants/${languageId}`,\n       requestBody ,\n      { headers: customHeaders }\n      \n    );\n\n    require(\"fs\").appendFileSync(\"debug.txt\", `‚úÖ Variant update success for language ${languageId}` + \"\\n\");\n    return response.data;\n  } catch (error) {\n    if (axios.isAxiosError(error)) {\n                // Handle axios errors\n                require(\"fs\").appendFileSync(\"debug.txt\", `Error Adding language variant | Axios error: ${error}` + \"\\n\");\n            } else {\n                // Handle non-axios errors\n                require(\"fs\").appendFileSync(\"debug.txt\", `Error Adding language variant | Non-axios error: ${error}` + \"\\n\");\n            }\n    throw error;\n  }\n}\n\nasync function fetchReviewStepId() {\n  try {\n    // https://manage.kontent.ai/v2/projects/0fbc3572-8f63-0030-94d3-231315ab5e58/workflows\n    const response = await axios.get(\n      `${config.baseUrl}/${config.projectId}/workflows`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n\n    const { data } = response;\n\n    const defaultWorkflow = data.filter(\n      (d: { codename: string }) => d.codename === \"default\"\n    );\n\n    const reviewStep = defaultWorkflow[0].steps.filter(\n      (d: { codename: string }) => d.codename === \"review\"\n    );\n\n    return reviewStep[0]?.id;\n  } catch (error) {\n    console.error(`Error publishing language variant: ${error}`);\n    throw error;\n  }\n}\n\nasync function transitionLanguageToReview(\n  itemId: string,\n  languageId: string,\n  reviewStepId: string\n) {\n  // https://manage.kontent.ai/v2/projects/0fbc3572-8f63-0030-94d3-231315ab5e58/items/23de5f44-473b-5817-8128-4e12c2e495ad/variants/codename/default/change-workflow\n  try {\n    const response = await axios.put(\n      `${config.baseUrl}/${config.projectId}/items/${itemId}/variants/codename/${languageId}/change-workflow`,\n      {\n        workflow_identifier: {\n          codename: \"default\",\n        },\n        step_identifier: {\n          id: reviewStepId,\n        },\n      },\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n    return response.data;\n  } catch (error) {\n    console.error(`Error publishing language variant: ${error}`);\n    throw error;\n  }\n}\n\nasync function publishLanguageVariant(itemId: string, languageId: string) {\n  try {\n    const scheduledTo = new Date(Date.now() + 30 * 60 * 1000).toISOString();\n\n    const payload = {\n      scheduled_to: scheduledTo,\n      display_timezone: \"Asia/Kolkata\"\n    };\n\n    const OmitPayload = {\n      \n    };\n\n    const response = await axios.put(\n      `${config.baseUrl}/${config.projectId}/items/${itemId}/variants/codename/${languageId}/publish`,\n      OmitPayload,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Accept\": \"application/json\",\n          Authorization: `Bearer ${config.apiKey}`,\n        },\n      }\n    );\n    require(\"fs\").appendFileSync(\"debug.txt\", `‚úÖ Published language variant ${languageId}` + \"\\n\");\n    return response.data;\n  } catch (error) {\n    //console.error(`Error publishing language variant: ${error}`);\n    require(\"fs\").appendFileSync(\"debug.txt\", `Error publishing language variant: ${error}` + \"\\n\");\n    throw error;\n  }\n}\n\ntype CsvRow = Record<string, string>;\n\nfunction mapCsvRowToElements(row: CsvRow, languageColumn: string) {\n  return [\n    {\n      element: { codename: \"title\" },\n      value: row[languageColumn] || row[\"default\"] || \"\",\n    },\n  ];\n}\n\nfunction getLanguageInfo(languageCode: string): { codename: string; id: string } | undefined {\n\n  return languageMap[languageCode];\n}\n\nasync function doesLanguageVariantExist(itemId: string, languageCodename: string): Promise<boolean> {\n  try {\n    const response = await axios.get(\n      `${config.baseUrl}/${config.projectId}/items/${itemId}/variants/codename/${languageCodename}`,\n      {\n        headers: {\n          Authorization: `Bearer ${config.apiKey}`,\n          \"Content-Type\": \"application/json\",\n        },\n      }\n    );\n    return response.status === 200;\n    \n  } catch (error: any) {\n    if (error.response?.status === 404) return false;\n    throw error;\n  }\n}\n\nfunction compressAndEscapeHtml(html: string): string {\n  const compressedHtml = html\n    .replace(/<!--[\\s\\S]*?-->/g, '') // Remove all HTML comments\n    .replace(/\\s{2,}/g, ' ')         // Collapse multiple spaces\n    .replace(/\\n/g, '')              // Remove newlines\n    .replace(/\\r/g, '')              // Remove carriage returns\n    .replace(/>\\s+</g, '><')         // Remove whitespace between tags\n    //.replace(/\"/g, \"'\")             // Replace double quotes with single quotes\n    .replace(/\\\\\"/g, '\"')  // Replace \\\" with \"\n    .replace(/\\\"/, '\"') // Replace \\\" with \"\n    .trim();                         // Remove leading/trailing spaces\n\n  //const escapedHtml = compressedHtml.replace(/\"/g, '\\\\\"'); // Escape double quotes\n\n  return compressedHtml;\n}\n\nexport async function processXlsxFile(\n  filePath: string,\n  userEnvVariable: string,\n  type: string\n) {\n  console.log(`Processing XLSX file: ${filePath}`);\n\n  const workbook = xlsx.readFile(filePath);\n  const sheet = workbook.Sheets[workbook.SheetNames[0]];\n  const rows: any[][] = xlsx.utils.sheet_to_json(sheet, { header: 1 });\n\n  const languageVariablePairs: {\n    language: string;\n    variable: string;\n    columnIndex: number;\n  }[] = [];\n\n  let currentLanguage = \"\";\n  for (let col = 3; col < rows[1].length; col++) {\n    const langCell = rows[0][col];\n    const variableCell = rows[1][col];\n\n    if (langCell?.trim()) currentLanguage = langCell.trim();\n    console.debug(`Processing column ${col}: Language: ${currentLanguage}, Variable: ${variableCell}`);\n    const variable = variableCell?.trim();\n    if (currentLanguage && variable) {\n      languageVariablePairs.push({\n        language: currentLanguage,\n        variable,\n        columnIndex: col,\n      });\n    }\n  }\n\n  //console.log(\"‚úÖ Extracted header pairs:\", languageVariablePairs);\n\n  const contentTypeCodename = \"travel_header_footer_model\";\n  config.projectId =\n    userEnvVariable === \"prod\" ? PROD_PROJECT_ID : DEV_PROJECT_ID;\n  config.apiKey = userEnvVariable === \"prod\"\n    ? (process.env.KONTENT_PROD_MANAGEMENT_API_KEY?.toString() ?? \"\")\n    : (process.env.KONTENT_DEV_MANAGEMENT_API_KEY?.toString() ?? \"\");\n  config.contentTypeCodename = type;\n\n  //const rawElementIdMap = await fetchElementIdMap(contentTypeCodename);\n  let rawElementIdMap: any;\n  try {\n    rawElementIdMap = await fetchElementIdMap(contentTypeCodename);\n    //console.log(\"üó∫Ô∏è Element ID Map Fetched:\", rawElementIdMap);\n  } catch (error) {\n    //console.error(\"‚ùå Failed to fetch element ID map:\", error);\n    require(\"fs\").appendFileSync(\"debug.txt\", \"‚ùå Failed to fetch element ID map:\" + error + \"\\n\");\n    throw error; // Important: rethrow to propagate\n  }\n\n  const elementIdMap: Record<string, string> = {};\n  for (const [key, value] of Object.entries(rawElementIdMap)) {\n    if (typeof value === \"string\") {\n      const normalizedKey = key.replace(/\\s+/g, \" \").trim();\n      require(\"fs\").appendFileSync(\"debug.txt\", `üîë Normalizing key: \"${key}\" to \"${normalizedKey}\" with value: ${value}` + \"\\n\");\n      elementIdMap[normalizedKey] = value;\n    } else {\n      //console.warn(`‚ö†Ô∏è Unexpected non-string value for key: ${key}`, value);\n      require(\"fs\").appendFileSync(\"debug.txt\", `‚ö†Ô∏è Unexpected non-string value for key: ${key}` + value + \"\\n\");\n    }\n  }\n\n  //console.log(\"üó∫Ô∏è Normalized elementIdMap keys:\", Object.keys(elementIdMap));\n\n  let processedCount = 0;\n  let unprocessedCount = 0;\n  const unprocessedRecords: { name: string; reason: string }[] = [];\n\n  for (let i = 2; i < rows.length; i++) {\n    const row = rows[i];\n    if (!row[2]) continue;\n\n    const originalName = String(row[2]).trim();\n    const codenameBase = originalName.replace(/\\s+/g, \"_\").toLowerCase();\n    const templateSuffix = type === \"email_template\" ? \"email\" : \"web\";\n    const itemName =\n      originalName + \" \" + templateSuffix.charAt(0).toUpperCase() + templateSuffix.slice(1);\n    const itemCodename = `${codenameBase}_${templateSuffix}`;\n\n    try {\n      let contentItem = await findContentItem(itemCodename);\n      //console.log(`üîç Searching for content item: ${itemCodename}`);\n      require(\"fs\").appendFileSync(\"debug.txt\", `üîç Searching for content item: ${itemCodename}` + \"\\n\");\n      \n      if (!contentItem) {\n        //console.log(`üîß Content item does not exist. Creating: ${itemCodename}`);\n        require(\"fs\").appendFileSync(\"debug.txt\", `üîß Content item does not exist. Creating: ${itemCodename}` + \"\\n\");\n        contentItem = await createContentItem(itemName, itemCodename, contentTypeCodename);\n      } else {\n        //console.log(`üîÑ Content item exists. Updating: ${itemCodename}`);\n        require(\"fs\").appendFileSync(\"debug.txt\", `üîÑ Content item exists. Updating: ${itemCodename}` + \"\\n\");\n      }\n\n      const reviewStepId =\n        userEnvVariable === \"prod\" ? await fetchReviewStepId() : null;\n\n      const languageElementMap: Record<string, any[]> = {};\n      const languageIdToCodenameMap: Record<string, string> = {};\n      const languageNameElementMap: Record<string, string> = {};\n      const languageClientIDElementMap: Record<string, string> = {};\n      const languageProgramIDElementMap: Record<string, string> = {};\n      //console.log(`üìÑ Check point 1 Processing item: ${itemName} (${itemCodename})`);\n      \n      for (const { language, variable, columnIndex } of languageVariablePairs) {\n        const value = row[columnIndex]; //HTML, CSS, Script values\n        require(\"fs\").appendFileSync(\"debug.txt\", `üìÑ Check point 1 Processing item: ${itemName} (${itemCodename}) | ${language.trim()} | Columnn: ${columnIndex} | Variable: ${variable} ` + \"\\n\");\n        const languageInfo = languageMap[language.trim()];\n        //console.log(`üîé Processing language: \"${language}\" with variable: \"${variable}\" and value: \"${value}\"`);\n        require(\"fs\").appendFileSync(\"debug.txt\", `üîé Processing language: \"${languageInfo.codename}\" | \"${languageInfo.id}\" and value: XXX` + \"\\n\");\n        if (!languageInfo) {\n          //console.warn(`‚ö†Ô∏è Language not found: \"${language}\"`);\n          require(\"fs\").appendFileSync(\"debug.txt\", `‚ö†Ô∏è Language not found: \"${language}\"` + \"\\n\");\n          continue;\n        }\n\n        const languageId = languageInfo.id;\n        const languageCodename = languageInfo.codename;\n        languageIdToCodenameMap[languageId] = languageCodename;\n        languageNameElementMap[languageId] = row[2] + \" Web\"; // Name value from the third column\n        languageClientIDElementMap[languageId] = \"client_id_list_\" + row[1].toString().toLowerCase();; // Client ID value\n        languageProgramIDElementMap[languageId] = \"program_id_list_\" + row[2].toString().replace(/\\s+/g, \"_\").toLowerCase();; // Program ID value\n\n        const withoutPrefix = variable\n          .replace(/^(Web|Email)\\s+/i, \"\") // remove prefix\n          .replace(/\\b(HTML|Style|Script)\\b/, (match: string): string => {\n            switch (match) {\n              case \"HTML\":\n                return \"HTML\";\n              case \"Style\":\n                return \"CSS\"; // your `elementIdMap` uses 'CSS' not 'Style'\n              case \"Script\":\n                return \"Script\";\n              default:\n                return match; // fallback: safe default to match itself\n            }\n          })\n\n        const normalizedVariable = withoutPrefix.replace(/\\s+/g, \" \").trim();\n        //console.log(`üîé Final mapped variable: \"${normalizedVariable}\"`);\n        const elementId = elementIdMap[normalizedVariable];\n\n        if (!elementId) {\n          //console.warn(`‚ö†Ô∏è Element ID not found for variable: \"${normalizedVariable}\"`);\n          require(\"fs\").appendFileSync(\"debug.txt\", `‚ö†Ô∏è Element ID not found for variable: \"${normalizedVariable}\"` + \"\\n\");\n          continue;\n        }\n        if (!languageId) {\n          //console.warn(`‚ö†Ô∏è Language code not found for: \"${language}\"`);\n          require(\"fs\").appendFileSync(\"debug.txt\", `‚ö†Ô∏è Language code not found for: \"${language}\"` + \"\\n\");\n          continue;\n        }\n\n        const isCustom = true; // for now assuming all are custom ‚Äî adjust if needed\n\n        //if (!languageElementMap[languageId]) languageElementMap[languageId] = [];\n\n        //const htmlValue = String(value || \"\").trim();\n        let safeHtml = String(value || \"\").trim();\n        try {\n          require(\"fs\").appendFileSync(\"debug.txt\", `üîé Processing value for variable \"${normalizedVariable}\": ` + \"\\n\");\n\n          if (normalizedVariable === \"Header HTML\" || normalizedVariable === \"Footer HTML\" || normalizedVariable === \"Header CSS\" || normalizedVariable === \"Footer CSS\") {\n          safeHtml =  compressAndEscapeHtml(String(value || \"\")); // Compress and escape HTML value\n        }\n        } catch (e) {\n          console.error(\"‚ùå Failed to write to debug.txt:\", e);\n        }\n        \n\n\n// languageElementMap[languageId].push({\n//   element: { id: elementId },\n//   value: { html: htmlValue },\n//   type: \"custom\" // Explicitly typed and always structured the same\n// });\n//require(\"fs\").appendFileSync(\"debug.txt\", `üì• Adding element: ${normalizedVariable} with ID: ${elementId} for language: ${languageId} with value: ${safeHtml}` + \"\\n\");\n\n\nif (!languageElementMap[languageInfo.id]) {\n  languageElementMap[languageInfo.id] = [];\n}\n\n  if (typeof safeHtml === \"string\" && safeHtml.trim().length > 0) {\n    languageElementMap[languageId].push({\n      element: { id: elementId },\n      value: safeHtml,\n    });\n  }\n\n    \n\n        // Send update per language\n        // for (const [langCodename, elements] of Object.entries(languageElementMap)) {\n        //   const languageCodename = languageIdToCodenameMap[langCodename];\n        //   const langEntry = languageMap[language.trim()]; // üëà get the language object\n\n          \n        // }\n        //require(\"fs\").appendFileSync(\"debug.txt\", `üìÑ Check point 2 Completed element mapping for item: ${itemName} (${itemCodename}) | ${language.trim()} | ${languageId} | Columnn: ${columnIndex} | Variable: ${variable} ` + \"\\n\");\n        \n        //await createLanguagVariant(contentItem.id, languageId); // ‚úÖ pass correct ID\n          //require(\"fs\").appendFileSync(\"debug.txt\", \"languageElementMap: \" + languageElementMap[langEntry.id] + \"\\n\");\n        //await addLanguageVariant(contentItem.id, languageId, templateSuffix, languageNameElementMap[languageId], languageClientIDElementMap[languageId], languageProgramIDElementMap[languageId], languageElementMap[languageId]); // ‚ö†Ô∏è must still use codename here\n\n        if (userEnvVariable === \"prod\") {\n            //await transitionLanguageToReview(contentItem.id, langEntry.codename, reviewStepId);\n          }\n        //await publishLanguageVariant(contentItem.id, langEntry.codename);\n\n        \n        \n      } //languageVariablePairs for loop ends\n\n      //require(\"fs\").appendFileSync(\"debug.txt\", `languageElementMap: ${JSON.stringify(languageElementMap, null, 2)}` + \"\\n\");\n\n\n      processedCount++;      // Now, iterate over each language and update/create variants\n\n      for (const [langId, elements] of Object.entries(languageElementMap)) {\n\n        if (elements.length === 0) {\n          require(\"fs\").appendFileSync(\"debug.txt\", `‚ö†Ô∏è No elements to process for language ID: ${langId}. Skipping.` + \"\\n\");\n          continue; // Skip if no elements to process\n        }\n\n        const languageCodename = languageIdToCodenameMap[langId];\n        require(\"fs\").appendFileSync(\"debug.txt\", `üì§ Updating/Creating variant for language: ${languageCodename} with elements: ` + \"\\n\"); //${JSON.stringify(elements, null, 2)}\n      \n\n        const variantExists = await doesLanguageVariantExist(contentItem.id, languageCodename);\n        require(\"fs\").appendFileSync(\"debug.txt\", `Variant details for language ${languageCodename}: ${JSON.stringify(variantExists, null, 2)}` + \"\\n\");\n        \n        if (!variantExists) {\n          require(\"fs\").appendFileSync(\"debug.txt\", `üîß Variant does not exist for language: ${languageCodename}. Creating new variant.` + \"\\n\");\n          //await createContentItem(itemName, itemCodename, contentTypeCodename);\n          //await createLanguagVariant(contentItem.id, languageCodename);\n        } else {\n          require(\"fs\").appendFileSync(\"debug.txt\", `üîÑ Variant exists for language: ${languageCodename}. Updating existing variant.` + \"\\n\");\n          //delete existing draft version if any\n          await deleteExistingDraftVersion (contentItem.id, languageCodename, variantExists);\n\n          //After deleting create new content item version\n          //await createContentItem(itemName, itemCodename, contentTypeCodename);\n          \n          await createLanguagVariant(contentItem.id, languageCodename); // create new version before update\n        }\n\n        await addLanguageVariant(\n          contentItem.id,\n          langId, // Use language ID instead of codename\n          templateSuffix,\n          languageNameElementMap[langId],\n          languageClientIDElementMap[langId],\n          languageProgramIDElementMap[langId],\n          elements\n        );\n        \n        if (userEnvVariable === \"prod\" && reviewStepId) {\n          await transitionLanguageToReview(contentItem.id, languageCodename, reviewStepId);\n        } \n        await publishLanguageVariant(contentItem.id, languageCodename);\n      }\n\n      require(\"fs\").appendFileSync(\"debug.txt\", `‚úÖ Successfully processed item: ${originalName}` + \"\\n\");\n      \n    } catch (error) {\n      const err = error as AxiosError;\n      const response = err?.response?.data as ApiErrorResponse;\n      const reason = response?.validation_errors?.[0]?.message || err.message;\n      //console.error(`‚ùå Error processing item: ${originalName}: ${reason}`);\n      require(\"fs\").appendFileSync(\"debug.txt\", `‚ùå Error processing item: ${originalName}: ${reason}` + \"\\n\");\n      unprocessedRecords.push({ name: originalName, reason });\n      unprocessedCount++; \n    }\n  }\n\n  return {\n    processedCount,\n    unprocessedCount,\n    unprocessedRecords,\n  };\n}\n","// pages/api/upload.ts\nimport { NextApiRequest, NextApiResponse } from \"next\";\nimport { IncomingForm, Fields, Files } from \"formidable\";\nimport dotenv from \"dotenv\";\nimport { processXlsxFile } from \"@/utils/headerfootergenerator\";\n\ndotenv.config();\n\nexport const config = {\n  api: {\n    bodyParser: false,\n    externalResolver: true,   // <- Tells Next.js this is handled manually\n  },\n  runtime: \"nodejs\", // <- Force Node.js runtime (not edge)\n};\n\ntype FileResponseType = {\n  processedCount: number;\n  unprocessedCount: number;\n  unprocessedRecords: { name: string; reason: string }[];\n};\n\nconst parseForm = (\n  req: NextApiRequest\n): Promise<{ fields: Fields; files: Files }> => {\n  const form = new IncomingForm();\n\n  return new Promise((resolve, reject) => {\n    form.parse(req, (err, fields, files) => {\n      console.log(\"üì• Inside form.parse()\");\n      if (err) {\n        console.error(\"‚ùå Error during form parsing:\", err);\n        return reject(err);\n      }\n      resolve({ fields, files });\n    });\n  });\n};\n\nconst uploadHandler = async (req: NextApiRequest, res: NextApiResponse) => {\n  console.log(\"Received request method:\", req.method);\n  if (req.method !== \"POST\") {\n    return res.status(405).json({ message: \"Method Not Allowed\" });\n  }\n\n  try {\n    const { files, fields } = await parseForm(req);\n\n    if (!files.file) {\n      return res.status(400).json({ message: \"No file uploaded\" });\n    }\n\n    const uploadedFile = Array.isArray(files.file) ? files.file[0] : files.file;\n\n    if (!uploadedFile.filepath) {\n      return res.status(400).json({ message: \"Invalid file upload\" });\n    }\n    const userEnvVariable = fields.environment as string[];\n    const type = fields.type as string[];\n    const file = uploadedFile.filepath; // Ensure `filepath` is correct for your version\n    const response: FileResponseType = (await processXlsxFile(\n      file,\n      userEnvVariable[0],\n      type[0]\n    )) as FileResponseType;\n    return res.status(200).json({\n      message: `File processed successfully`,\n      processedCount: response.processedCount,\n      unprocessedCount: response.unprocessedCount,\n      unprocessedRecords: response.unprocessedRecords,\n    });\n  } catch (error) {\n    console.error(\"‚ùå Error processing upload:\", error);\n    const errorMsg = error instanceof Error ? error.message : \"Error processing file\";\n    return res.status(500).json({ message: errorMsg });\n  }\n};\n\nexport default uploadHandler;\n","import type { NextApiResponse } from '../../types'\nimport type { IncomingMessage, ServerResponse } from 'node:http'\n\nimport { sendError } from '../../server/api-utils'\nimport { RouteKind } from '../../server/route-kind'\nimport type { Span } from '../../server/lib/trace/tracer'\nimport { PagesAPIRouteModule } from '../../server/route-modules/pages-api/module.compiled'\n\nimport { hoist } from './helpers'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getTracer, SpanKind } from '../../server/lib/trace/tracer'\nimport { BaseServerSpan } from '../../server/lib/trace/constants'\nimport type { InstrumentationOnRequestError } from '../../server/instrumentation/types'\nimport { addRequestMeta } from '../../server/request-meta'\n\n// Re-export the handler (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export config.\nexport const config = hoist(userland, 'config')\n\n// Create and export the route module that will be consumed.\nconst routeModule = new PagesAPIRouteModule({\n  definition: {\n    kind: RouteKind.PAGES_API,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  userland,\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n})\n\nexport async function handler(\n  req: IncomingMessage,\n  res: ServerResponse,\n  ctx: {\n    waitUntil?: (prom: Promise<void>) => void\n  }\n): Promise<void> {\n  if (routeModule.isDev) {\n    addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint())\n  }\n  let srcPage = 'VAR_DEFINITION_PAGE'\n\n  // turbopack doesn't normalize `/index` in the page name\n  // so we need to to process dynamic routes properly\n  // TODO: fix turbopack providing differing value from webpack\n  if (process.env.TURBOPACK) {\n    srcPage = srcPage.replace(/\\/index$/, '') || '/'\n  }\n\n  const prepareResult = await routeModule.prepare(req, res, { srcPage })\n\n  if (!prepareResult) {\n    res.statusCode = 400\n    res.end('Bad Request')\n    ctx.waitUntil?.(Promise.resolve())\n    return\n  }\n\n  const { query, params, prerenderManifest, routerServerContext } =\n    prepareResult\n\n  try {\n    const method = req.method || 'GET'\n    const tracer = getTracer()\n\n    const activeSpan = tracer.getActiveScopeSpan()\n    const onRequestError =\n      routeModule.instrumentationOnRequestError.bind(routeModule)\n\n    const invokeRouteModule = async (span?: Span) =>\n      routeModule\n        .render(req, res, {\n          query: {\n            ...query,\n            ...params,\n          },\n          params,\n          allowedRevalidateHeaderKeys: process.env\n            .__NEXT_ALLOWED_REVALIDATE_HEADERS as any as string[],\n          multiZoneDraftMode: Boolean(process.env.__NEXT_MULTI_ZONE_DRAFT_MODE),\n          trustHostHeader: process.env\n            .__NEXT_TRUST_HOST_HEADER as any as boolean,\n          // TODO: get this from from runtime env so manifest\n          // doesn't need to load\n          previewProps: prerenderManifest.preview,\n          propagateError: false,\n          dev: routeModule.isDev,\n          page: 'VAR_DEFINITION_PAGE',\n\n          internalRevalidate: routerServerContext?.revalidate,\n\n          onError: (...args: Parameters<InstrumentationOnRequestError>) =>\n            onRequestError(req, ...args),\n        })\n        .finally(() => {\n          if (!span) return\n\n          span.setAttributes({\n            'http.status_code': res.statusCode,\n            'next.rsc': false,\n          })\n\n          const rootSpanAttributes = tracer.getRootSpanAttributes()\n          // We were unable to get attributes, probably OTEL is not enabled\n          if (!rootSpanAttributes) {\n            return\n          }\n\n          if (\n            rootSpanAttributes.get('next.span_type') !==\n            BaseServerSpan.handleRequest\n          ) {\n            console.warn(\n              `Unexpected root span type '${rootSpanAttributes.get(\n                'next.span_type'\n              )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n            )\n            return\n          }\n\n          const route = rootSpanAttributes.get('next.route')\n          if (route) {\n            const name = `${method} ${route}`\n\n            span.setAttributes({\n              'next.route': route,\n              'http.route': route,\n              'next.span_name': name,\n            })\n            span.updateName(name)\n          } else {\n            span.updateName(`${method} ${srcPage}`)\n          }\n        })\n\n    // TODO: activeSpan code path is for when wrapped by\n    // next-server can be removed when this is no longer used\n    if (activeSpan) {\n      await invokeRouteModule(activeSpan)\n    } else {\n      await tracer.withPropagatedContext(req.headers, () =>\n        tracer.trace(\n          BaseServerSpan.handleRequest,\n          {\n            spanName: `${method} ${srcPage}`,\n            kind: SpanKind.SERVER,\n            attributes: {\n              'http.method': method,\n              'http.target': req.url,\n            },\n          },\n          invokeRouteModule\n        )\n      )\n    }\n  } catch (err) {\n    // we re-throw in dev to show the error overlay\n    if (routeModule.isDev) {\n      throw err\n    }\n    // this is technically an invariant as error handling\n    // should be done inside of api-resolver onError\n    sendError(res as NextApiResponse, 500, 'Internal Server Error')\n  } finally {\n    // We don't allow any waitUntil work in pages API routes currently\n    // so if callback is present return with resolved promise since no\n    // pending work\n    ctx.waitUntil?.(Promise.resolve())\n  }\n}\n"],"names":["sendError","RouteKind","PagesAPIRouteModule","hoist","userland","getTracer","SpanKind","BaseServerSpan","addRequestMeta","config","routeModule","definition","kind","PAGES_API","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","handler","req","res","ctx","isDev","hrtime","bigint","srcPage","TURBOPACK","replace","prepareResult","prepare","statusCode","end","waitUntil","Promise","resolve","query","params","prerenderManifest","routerServerContext","method","tracer","activeSpan","getActiveScopeSpan","onRequestError","instrumentationOnRequestError","bind","invokeRouteModule","span","render","allowedRevalidateHeaderKeys","__NEXT_ALLOWED_REVALIDATE_HEADERS","multiZoneDraftMode","Boolean","__NEXT_MULTI_ZONE_DRAFT_MODE","trustHostHeader","__NEXT_TRUST_HOST_HEADER","previewProps","preview","propagateError","dev","internalRevalidate","revalidate","onError","args","finally","setAttributes","rootSpanAttributes","getRootSpanAttributes","get","handleRequest","console","warn","route","name","updateName","withPropagatedContext","headers","trace","spanName","SERVER","attributes","url","err"],"mappings":"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","ignoreList":[2]}