(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[306],{498:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(1713).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1713:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var a=l(4232);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,l)=>l?l.toUpperCase():t.toLowerCase()),n=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];return t.filter((e,t,l)=>!!e&&""!==e.trim()&&l.indexOf(e)===t).join(" ").trim()};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)((e,t)=>{let{color:l="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:c="",children:i,iconNode:m,...x}=e;return(0,a.createElement)("svg",{ref:t,...d,width:s,height:s,stroke:l,strokeWidth:n?24*Number(r)/Number(s):r,className:o("lucide",c),...x},[...m.map(e=>{let[t,l]=e;return(0,a.createElement)(t,l)}),...Array.isArray(i)?i:[i]])}),i=(e,t)=>{let l=(0,a.forwardRef)((l,r)=>{let{className:d,...i}=l;return(0,a.createElement)(c,{ref:r,iconNode:t,className:o("lucide-".concat(s(n(e))),"lucide-".concat(e),d),...i})});return l.displayName=n(e),l}},6257:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(1713).A)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},6642:(e,t,l)=>{"use strict";l.d(t,{N:()=>r});var a=l(7876),s=l(4232);let r=e=>{let{environment:t,systemType:l,disabled:r}=e,[n,o]=(0,s.useState)(0),[d,c]=(0,s.useState)(!1),i=()=>{let e=setInterval(async()=>{let t=await fetch("/api/exportProgress",{cache:"no-store"}),l=await t.json();o(l.progress),l.progress>=100&&(clearInterval(e),c(!1))},1e3)},m=async()=>{if(!t||!l)return void alert("Please select Environment and List");o(0),c(!0),i();let e=await fetch("/api/exportCSVList",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({environment:t,queryParams:{"system.type":l}})});if(!e.ok){c(!1),alert("Export failed");return}let a=await e.blob(),s=window.URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download="TravelHotel_".concat(t,"_").concat(l,".csv"),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(s)};return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{onClick:m,disabled:r||d,className:"bg-blue-500 text-white px-4 py-2 rounded disabled:opacity-50",children:d?"Exporting...":"Export List"}),d&&(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded transition-all",style:{width:"".concat(n,"%")}})}),d&&(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[n,"%"]})]})}},6739:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(1713).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9099:(e,t,l)=>{e.exports=l(8253)},9306:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>i});var a=l(7876),s=l(4232),r=l(6257),n=l(6739),o=l(498),d=l(9099),c=l(6642);function i(){let[e,t]=(0,s.useState)(null),[l,i]=(0,s.useState)("dev"),[m,x]=(0,s.useState)([]),[u,p]=(0,s.useState)(""),[h,g]=(0,s.useState)([]),[b,f]=(0,s.useState)("default"),[y,v]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),[w,k]=(0,s.useState)(null),[C,S]=(0,s.useState)(!0),[E,L]=(0,s.useState)(!0),A=(0,d.useRouter)();(0,s.useEffect)(()=>{"/prod"===A.asPath?i("prod"):i("dev")},[A.asPath]),(0,s.useEffect)(()=>{(async()=>{S(!0);try{let e=await fetch("/api/types");if(!e.ok)throw Error("Failed to fetch types");let t=await e.json();x(t.types||[])}catch(e){console.error("Error fetching types:",e),k("Failed to load file types. Please refresh the page.")}finally{S(!1)}})()},[]),(0,s.useEffect)(()=>{(async()=>{L(!0);try{let e=await fetch("/api/languages");if(!e.ok)throw Error("Failed to fetch languages");let t=await e.json();g(t.languages||[])}catch(e){console.error("Error fetching languages:",e),k("Failed to load languages. Please refresh the page.")}finally{L(!1)}})()},[]);let P=()=>{if(!e)return k("Please select a file."),!1;if(!u)return k("Please select a type."),!1;if(!b)return k("Please select a language."),!1;let t=m.find(e=>e.codename===u);return t?h.find(e=>e.codename===b)?e.name==="".concat(t.codename,".csv")||(k('Filename must be "'.concat(t.codename,'.csv".')),!1):(k("Invalid language selected."),!1):(k("Invalid type selected."),!1)},R=async()=>{if(N(null),k(null),!P())return;let t=new FormData;t.append("file",e),t.append("environment",l),t.append("type",u),v(!0);try{let e=await fetch("/api/upload",{method:"POST",body:t}),l=await e.json();e.ok?N(l):k(l.message||"Error uploading file.")}catch(e){console.error("Error uploading file",e),k("Error uploading file. Please try again.")}finally{v(!1)}},F=()=>{t(null),p(""),N(null),k(null);let e=document.getElementById("fileInput");e&&(e.value="")};return(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto bg-white rounded-xl shadow-md",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6 text-black",children:"PickList Bulk Uploader"}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Upload a CSV file to bulk import items into your PickList. Ensure the file is named correctly based on the selected type."}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:["Download Template for \xa0",(0,a.jsx)("span",{className:"font-semibold",children:"dev"===l?"Development":"Production"}),":",(0,a.jsx)("a",{href:"/api/getSampleTemplate",target:"_blank",rel:"noopener noreferrer",download:!0,"aria-label":"Download sample template",className:"button bg-green-600 hover:bg-green-500 px-4 py-2 rounded text-white  ml-1",children:"Sample Template"})]}),!j&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)("label",{className:"block text-sm font-medium text-black",htmlFor:"fileInput",children:"Upload CSV File"})}),(0,a.jsxs)("label",{htmlFor:"fileInput",className:"border-2 border-dashed rounded-lg p-8 flex flex-col items-center justify-center cursor-pointer transition-colors ".concat(e?"border-green-300 bg-green-50":"border-gray-300 hover:border-blue-400 hover:bg-blue-50"),children:[(0,a.jsx)(r.A,{className:e?"text-green-500":"text-gray-400",size:32}),(0,a.jsx)("span",{className:"mt-2 text-sm text-gray-600",children:e?e.name:"Click to select a CSV file or drag and drop"}),(0,a.jsx)("input",{id:"fileInput",type:"file",accept:".csv",onChange:e=>{e.target.files&&e.target.files.length>0&&(t(e.target.files[0]),k(null))},className:"hidden",disabled:y})]})]}),(0,a.jsxs)("div",{className:"columns-3 gap-4",children:[(0,a.jsxs)("div",{className:"relative ",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1 text-black",htmlFor:"environmentSelect",children:"Environment"}),(0,a.jsxs)("select",{id:"environmentSelect",value:l,onChange:e=>i(e.target.value),className:"block w-full bg-white appearance-none border border-gray-300 text-black p-2 rounded leading-tight focus:outline-none focus:border-blue-500",disabled:y,children:[(0,a.jsx)("option",{value:"dev",children:"Development"}),(0,a.jsx)("option",{value:"prod",children:"Production"})]}),(0,a.jsx)("div",{className:"pointer-events-none absolute top-8 right-0 flex items-center px-2 text-gray-700",children:(0,a.jsx)("svg",{className:"h-4 w-4 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,a.jsxs)("div",{className:"relative ",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1 text-black",htmlFor:"typeSelect",children:"File Type"}),(0,a.jsxs)("select",{id:"typeSelect",value:u,onChange:e=>p(e.target.value),className:"block w-full bg-white appearance-none border border-gray-300 text-black p-2 rounded leading-tight focus:outline-none focus:border-blue-500",disabled:C||0===m.length||y,children:[(0,a.jsx)("option",{value:"",children:"Select a type"}),m.map(e=>(0,a.jsx)("option",{value:e.codename,children:e.name},e.codename))]}),(0,a.jsx)("div",{className:"pointer-events-none absolute top-8 right-0 flex items-center px-2 text-gray-700",children:(0,a.jsx)("svg",{className:"h-4 w-4 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})}),C&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Loading types..."}),!C&&0===m.length&&(0,a.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"No file types available"})]}),(0,a.jsxs)("div",{className:"relative ",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1 text-black",htmlFor:"languageSelect",children:"Languages"}),(0,a.jsx)("select",{id:"languageSelect",value:b,onChange:e=>f(e.target.value),className:"block w-full bg-white appearance-none border border-gray-300 text-black p-2 rounded leading-tight focus:outline-none focus:border-blue-500",children:h.map(e=>(0,a.jsx)("option",{value:e.codename,children:e.name},e.codename))}),(0,a.jsx)("div",{className:"pointer-events-none absolute top-8 right-0 flex items-center px-2 text-gray-700",children:(0,a.jsx)("svg",{className:"h-4 w-4 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})}),E&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Loading languages..."}),!E&&0===h.length&&(0,a.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"No language available"})]})]}),w&&(0,a.jsxs)("div",{className:"flex items-center p-3 bg-red-50 border border-red-200 rounded text-red-800",role:"alert",children:[(0,a.jsx)(n.A,{size:20,className:"text-red-500 mr-2"}),(0,a.jsx)("p",{className:"text-sm",children:w})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:R,className:"px-4 py-2 bg-orange-500 text-white rounded transition-colors hover:bg-orange-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:y||!e||!u,type:"button",children:y?"Uploading...":"Upload File"}),(0,a.jsx)(c.N,{environment:l,systemType:u,disabled:!l||!u}),(0,a.jsx)("button",{onClick:F,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50",disabled:y,type:"button",children:"Reset"})]})]}),j&&(0,a.jsxs)("div",{className:"mt-8 border-t pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(o.A,{size:24,className:"text-green-500 mr-2"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-black",children:"Upload Complete"})]}),(0,a.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded mb-4 text-black",children:[(0,a.jsx)("p",{children:j.message}),(0,a.jsxs)("div",{className:"flex space-x-8 mt-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Processed:"}),(0,a.jsxs)("span",{className:"ml-2 font-semibold ".concat(j.processedCount<=0?"text-orange-600":"text-green-600"),children:[j.processedCount," records"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Unprocessed:"}),(0,a.jsxs)("span",{className:"ml-2 font-semibold ".concat(j.unprocessedCount>0?"text-orange-600":"text-green-600"),children:[j.unprocessedCount," records"]})]})]})]}),j.unprocessedCount>0&&j.unprocessedRecords&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Unprocessed Records:"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full border border-gray-200 rounded",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Name"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Reason"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:j.unprocessedRecords.map((e,t)=>(0,a.jsxs)("tr",{className:"bg-white",children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.name}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-red-600",children:e.reason})]},t))})]})})]}),(0,a.jsx)("div",{className:"flex justify-between mt-6",children:(0,a.jsx)("button",{onClick:F,className:"px-4 py-2 bg-blue-50 text-blue-600 border border-blue-200 rounded hover:bg-blue-100 transition-colors",type:"button",children:"Upload Another File"})})]})]})}}}]);